<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Learning ESP-DL Series 03: Neural Network Architecture | Embedded Projects</title><meta name="author" content="tommok"><meta name="copyright" content="tommok"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="IntroductionIn the previous blog, we walked through how to prepare the dataset, train, quantize, and deploy the model to the ESP32-S3, following the ESP-DL digit recognition example code:https:&#x2F;&#x2F;githu">
<meta property="og:type" content="article">
<meta property="og:title" content="Learning ESP-DL Series 03: Neural Network Architecture">
<meta property="og:url" content="https://tommokmok.github.io/2025/08/27/Learning-ESP-DL-Series-03-Neural-Network-Architecture/index.html">
<meta property="og:site_name" content="Embedded Projects">
<meta property="og:description" content="IntroductionIn the previous blog, we walked through how to prepare the dataset, train, quantize, and deploy the model to the ESP32-S3, following the ESP-DL digit recognition example code:https:&#x2F;&#x2F;githu">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://tommokmok.github.io/img/mcu.jpg">
<meta property="article:published_time" content="2025-08-27T07:58:43.000Z">
<meta property="article:modified_time" content="2025-09-02T04:50:57.880Z">
<meta property="article:author" content="tommok">
<meta property="article:tag" content="ESP-DL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tommokmok.github.io/img/mcu.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Learning ESP-DL Series 03: Neural Network Architecture",
  "url": "https://tommokmok.github.io/2025/08/27/Learning-ESP-DL-Series-03-Neural-Network-Architecture/",
  "image": "https://tommokmok.github.io/img/mcu.jpg",
  "datePublished": "2025-08-27T07:58:43.000Z",
  "dateModified": "2025-09-02T04:50:57.880Z",
  "author": [
    {
      "@type": "Person",
      "name": "tommok",
      "url": "https://tommokmok.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/embedded_32_32.png"><link rel="canonical" href="https://tommokmok.github.io/2025/08/27/Learning-ESP-DL-Series-03-Neural-Network-Architecture/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Learning ESP-DL Series 03: Neural Network Architecture',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Embedded Projects</span></a><a class="nav-page-title" href="/"><span class="site-name">Learning ESP-DL Series 03: Neural Network Architecture</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"></div></nav><div id="post-info"><h1 class="post-title">Learning ESP-DL Series 03: Neural Network Architecture</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-08-27T07:58:43.000Z" title="Created 2025-08-27 15:58:43">2025-08-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-09-02T04:50:57.880Z" title="Updated 2025-09-02 12:50:57">2025-09-02</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Coding/">Coding</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>In the previous blog, we walked through how to prepare the dataset, train, quantize, and deploy the model to the ESP32-S3, following the ESP-DL digit recognition example code:<br><a target="_blank" rel="noopener" href="https://github.com/espressif/esp-iot-solution/tree/master/examples/ai/esp_dl/touchpad_digit_recognition">https://github.com/espressif/esp-iot-solution/tree/master/examples/ai/esp_dl/touchpad_digit_recognition</a></p>
<p>However, we did not take a closer look at how the neural network itself is designed.</p>
<p>In this post, I will explain the details of the neural network architecture based on my understanding.</p>
<p>Later on, I plan to use this model as a foundation to develop my own digit and alphabet character recognition system.</p>
<h1 id="How-This-Blog-May-Help-You"><a href="#How-This-Blog-May-Help-You" class="headerlink" title="How This Blog May Help You"></a>How This Blog May Help You</h1><ul>
<li>Gain a deeper understanding of how the neural network in the ESP-DL digit recognition example works.</li>
<li>Learn about the structure and parameter calculation of a typical CNN for embedded AI.</li>
</ul>
<h1 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h1><ul>
<li>Basic concepts of how Convolutional Neural Networks (CNNs) work.</li>
<li>Recommended: Explore <a target="_blank" rel="noopener" href="https://poloclub.github.io/cnn-explainer/">https://poloclub.github.io/cnn-explainer/</a> for interactive CNN explanations.</li>
</ul>
<span id="more"></span>

<h1 id="Layer-Explanation"><a href="#Layer-Explanation" class="headerlink" title="Layer Explanation"></a>Layer Explanation</h1><p>The model contains 7 main neural network operations:</p>
<ol>
<li><strong>Conv2D</strong>: Think of this as a window (kernel) that slides over the input matrix, performing multiplication and summation at each position.</li>
<li><strong>ReLU</strong>: An activation function that introduces non-linearity.</li>
<li><strong>MaxPool2D</strong>: A downsampling operation that reduces the spatial dimensions of the matrix.</li>
<li><strong>Flatten</strong>: Converts a 2D array into a 1D array.</li>
<li><strong>Linear</strong>: A standard fully connected (dense) neural network layer.</li>
<li><strong>Dropout</strong>: Randomly sets some weights to zero during training to prevent overfitting.</li>
<li><strong>Softmax</strong>: Converts raw output values into probabilities.</li>
</ol>
<p>The most important part is understanding how data flows from one layer to another. If the shapes do not match, the neural network will not work.</p>
<h2 id="Conv2D-→-kernel-size"><a href="#Conv2D-→-kernel-size" class="headerlink" title="Conv2D → kernel_size"></a><code>Conv2D</code> → <code>kernel_size</code></h2><ul>
<li><code>kernel_size</code> is the heart of the CNN. It defines the size of the window (e.g., 3x3) that moves across the input.</li>
<li>For <code>kernel_size=3</code>, there is a 3x3 matrix of weights that the network learns and optimizes.</li>
<li>The term “kernel” is standard in CNNs, though “window” might be more intuitive.</li>
</ul>
<h2 id="Conv2D-→-in-channels-out-channels"><a href="#Conv2D-→-in-channels-out-channels" class="headerlink" title="Conv2D → in_channels &amp; out_channels"></a><code>Conv2D</code> → <code>in_channels</code> &amp; <code>out_channels</code></h2><ul>
<li><code>in_channels</code>: Number of input 2D arrays (channels).<br>For grayscale images, this is usually 1; for RGB, it’s 3.</li>
<li><code>out_channels</code>: Number of output 2D arrays after the convolution.</li>
<li>For example, <code>in_channels=1</code>, <code>out_channels=16</code> means the Conv2D layer will output 16 feature maps, each generated by a different kernel.</li>
</ul>
<h2 id="Conv2D-→-stride-padding"><a href="#Conv2D-→-stride-padding" class="headerlink" title="Conv2D → stride &amp; padding"></a><code>Conv2D</code> → <code>stride</code> &amp; <code>padding</code></h2><ul>
<li><code>stride</code>: Step size of the kernel as it moves across the input.<br><code>stride=1</code> means the kernel moves one pixel at a time.</li>
<li><code>padding</code>: Number of zeros (dummy values) added around the border of the input.<br><code>padding=1</code> adds a border of one pixel.</li>
</ul>
<h1 id="Output-Shape-of-Each-Layer"><a href="#Output-Shape-of-Each-Layer" class="headerlink" title="Output Shape of Each Layer"></a>Output Shape of Each Layer</h1><blockquote>
<p><strong>Note:</strong> In PyTorch, tensor shapes are typically defined as <code>[channels, height, width]</code>.</p>
</blockquote>
<ul>
<li><p><strong>Conv2D (in_channels&#x3D;1, out_channels&#x3D;16, kernel_size&#x3D;3, stride&#x3D;1, padding&#x3D;1):</strong></p>
<ul>
<li>Input: 25 x 30 (H x W)</li>
<li>After padding: 27 x 32 (H x W)</li>
<li>After convolution: 25 x 30 (H x W)</li>
</ul>
</li>
<li><p><strong>MaxPool2D (kernel_size&#x3D;2, stride&#x3D;2):</strong></p>
<ul>
<li>Output: 12 x 15 (H x W)</li>
<li><a target="_blank" rel="noopener" href="https://ibb.co/mCh8wgV7"><img src="https://i.ibb.co/mCh8wgV7/mzx-pool-shape-explain.png" alt="max-pool-shape-explain" border="0"></a></li>
<li><em>Note: In the vertical direction, the last row may be dropped if it doesn’t fit the pooling window.</em></li>
</ul>
</li>
<li><p><strong>Conv2D (in_channels&#x3D;16, out_channels&#x3D;32, kernel_size&#x3D;3, stride&#x3D;1, padding&#x3D;1):</strong></p>
<ul>
<li>Output: 12 x 15 (H x W)</li>
</ul>
</li>
<li><p><strong>MaxPool2D (kernel_size&#x3D;2, stride&#x3D;2):</strong></p>
<ul>
<li>Output: 6 x 7 (H x W)</li>
<li><a target="_blank" rel="noopener" href="https://ibb.co/xSv4vrj2"><img src="https://i.ibb.co/xSv4vrj2/second-max-pool-shape.png" alt="second-max-pool-shape" border="0"></a></li>
</ul>
</li>
<li><p><strong>Conv2D (in_channels&#x3D;32, out_channels&#x3D;64, kernel_size&#x3D;3, stride&#x3D;1, padding&#x3D;1):</strong></p>
<ul>
<li>Output: 6 x 7 (H x W), with 64 channels</li>
</ul>
</li>
<li><p><strong>Flatten:</strong></p>
<ul>
<li>Output: 1D array of size 1 x 2688 (6 x 7 x 64)</li>
</ul>
</li>
<li><p><strong>Linear (in_features&#x3D;2688, out_features&#x3D;256):</strong></p>
<ul>
<li>Output: 1 x 256</li>
</ul>
</li>
<li><p><strong>Final Linear Layer (in_features&#x3D;256, out_features&#x3D;10):</strong></p>
<ul>
<li>Output: 1 x 10 (for 10 digit classes)</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>Note:</strong> Sometimes, the height and width columns may appear swapped in summaries—always double-check your tensor shapes.</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://ibb.co/Gf0SWLN3"><img src="https://i.ibb.co/FkKT5MCq/cnn-model-summary.png" alt="cnn-model-summary" border="0"></a></p>
<h1 id="Parameter-Calculation"><a href="#Parameter-Calculation" class="headerlink" title="Parameter Calculation"></a>Parameter Calculation</h1><p>Understanding the number of parameters in each layer is fundamental to grasping how CNNs work.</p>
<ol>
<li><p><strong>First Conv2D Layer:</strong>  </p>
<ul>
<li>Input: 1 channel, Output: 16 channels, Kernel size: 3x3  </li>
<li>Each output channel has its own 3x3 kernel: 16 x 9 &#x3D; <strong>144</strong> weights  </li>
<li>Plus 16 bias values: 144 + 16 &#x3D; <strong>160</strong> parameters</li>
</ul>
</li>
<li><p><strong>First MaxPool2D Layer:</strong>  </p>
<ul>
<li>No parameters (just a downsampling operation)</li>
</ul>
</li>
<li><p><strong>Second Conv2D Layer:</strong>  </p>
<ul>
<li>Input: 16 channels, Output: 32 channels, Kernel size: 3x3  </li>
<li>16 x 32 x 9 &#x3D; <strong>4608</strong> weights  </li>
<li>Plus 32 bias values: 4608 + 32 &#x3D; <strong>4640</strong> parameters</li>
</ul>
</li>
<li><p><strong>Third Conv2D Layer:</strong>  </p>
<ul>
<li>Input: 32 channels, Output: 64 channels, Kernel size: 3x3  </li>
<li>32 x 64 x 9 &#x3D; <strong>18432</strong> weights  </li>
<li>Plus 64 bias values: 18432 + 64 &#x3D; <strong>18496</strong> parameters</li>
</ul>
</li>
<li><p><strong>First Linear Layer:</strong>  </p>
<ul>
<li>Input: 2688, Output: 256  </li>
<li>2688 x 256 &#x3D; <strong>688,128</strong> weights  </li>
<li>Plus 256 bias values: 688,128 + 256 &#x3D; <strong>688,384</strong> parameters</li>
</ul>
</li>
<li><p><strong>Final Linear Layer:</strong>  </p>
<ul>
<li>Input: 256, Output: 10  </li>
<li>256 x 10 &#x3D; <strong>2560</strong> weights  </li>
<li>Plus 10 bias values: 2560 + 10 &#x3D; <strong>2570</strong> parameters</li>
</ul>
</li>
</ol>
<blockquote>
<p><strong>Tip:</strong> The total number of parameters gives you an idea of the model’s complexity and memory requirements.</p>
</blockquote>
<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>In this post, I explained how the tensor shapes change through each layer of the CNN and detailed how to calculate the number of parameters in each layer. </p>
<p>Understanding these fundamentals will help you design and modify your own CNN architectures for embedded AI applications.</p>
<p>If you grasp these concepts, you are well on your way to building your own custom neural networks for tasks like digit or character recognition on embedded devices.</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://tommokmok.github.io">tommok</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://tommokmok.github.io/2025/08/27/Learning-ESP-DL-Series-03-Neural-Network-Architecture/">https://tommokmok.github.io/2025/08/27/Learning-ESP-DL-Series-03-Neural-Network-Architecture/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ESP-DL/">ESP-DL</a></div><div class="post-share"><div class="social-share" data-image="/img/mcu.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2025/08/27/Learning-ESP-DL-Series-02-Walkthrough-on-training-test-deploy/" title="Learning ESP-DL Series 02: Walkthrough on Training, Testing, and Deployment"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Learning ESP-DL Series 02: Walkthrough on Training, Testing, and Deployment</div></div><div class="info-2"><div class="info-item-1">IntroductionIn the previous blog, we updated the example code to be compatible with a general ESP32-S3 dev kit module. One issue with the ESP-DL digit recognition example is that they do not provide the original PyTorch model or the output files generated after the esp-ppq process. Only the final .espdl file is provided. Therefore, we need to build our own model based on their dataset. Fortunately, Espressif provides the code for training, testing, and quantizing the model. In this post, I wi...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/08/15/Learning-ESP-DL-Series-00-First-Impression/" title="Learning ESP-DL Series 2025 - 00: First Impression"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-15</div><div class="info-item-2">Learning ESP-DL Series 2025 - 00: First Impression</div></div><div class="info-2"><div class="info-item-1">IntroductionThis is the first post in a series of blogs that will explore the ESP-DL library in detail. At the time of writing, there is very little information or tutorials available for ESP-DL, especially practical guides on how to use it effectively. The official documentation from Espressif only explains what the library is, but does not clarify why you might need it, how to use it correctly, or provide helpful tips. In this post, I will focus on running an example code from the ESP-DL li...</div></div></div></a><a class="pagination-related" href="/2025/08/18/Learning-ESP-DL-Series-01-Digi-Recognition/" title="Learning ESP-DL Series 01: Digit Recognition"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-18</div><div class="info-item-2">Learning ESP-DL Series 01: Digit Recognition</div></div><div class="info-2"><div class="info-item-1">IntroductionIn the previous blog, we verified the hardware and development environment. This time, we will go through another interesting example: touchpad-digit-recognition. This is an ESP AI example that demonstrates the complete deep learning development workflow, from data collection and training to device deployment. In this blog, I will clone this example and run the code on my own hardware, which does not have a touch sensor. How This Blog May Help You Learn ESP-DL in detail. If you wa...</div></div></div></a><a class="pagination-related" href="/2025/08/27/Learning-ESP-DL-Series-02-Walkthrough-on-training-test-deploy/" title="Learning ESP-DL Series 02: Walkthrough on Training, Testing, and Deployment"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-27</div><div class="info-item-2">Learning ESP-DL Series 02: Walkthrough on Training, Testing, and Deployment</div></div><div class="info-2"><div class="info-item-1">IntroductionIn the previous blog, we updated the example code to be compatible with a general ESP32-S3 dev kit module. One issue with the ESP-DL digit recognition example is that they do not provide the original PyTorch model or the output files generated after the esp-ppq process. Only the final .espdl file is provided. Therefore, we need to build our own model based on their dataset. Fortunately, Espressif provides the code for training, testing, and quantizing the model. In this post, I wi...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/mcu.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">tommok</div><div class="author-info-description">Small project, small step to success</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">10</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">4</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/tommokmok"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">Get busy living or get busy dying. -- Stephen King</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#How-This-Blog-May-Help-You"><span class="toc-number">2.</span> <span class="toc-text">How This Blog May Help You</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Prerequisites"><span class="toc-number">3.</span> <span class="toc-text">Prerequisites</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Layer-Explanation"><span class="toc-number">4.</span> <span class="toc-text">Layer Explanation</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Conv2D-%E2%86%92-kernel-size"><span class="toc-number">4.1.</span> <span class="toc-text">Conv2D → kernel_size</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Conv2D-%E2%86%92-in-channels-out-channels"><span class="toc-number">4.2.</span> <span class="toc-text">Conv2D → in_channels &amp; out_channels</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Conv2D-%E2%86%92-stride-padding"><span class="toc-number">4.3.</span> <span class="toc-text">Conv2D → stride &amp; padding</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Output-Shape-of-Each-Layer"><span class="toc-number">5.</span> <span class="toc-text">Output Shape of Each Layer</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Parameter-Calculation"><span class="toc-number">6.</span> <span class="toc-text">Parameter Calculation</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Conclusion"><span class="toc-number">7.</span> <span class="toc-text">Conclusion</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/27/Learning-ESP-DL-Series-03-Neural-Network-Architecture/" title="Learning ESP-DL Series 03: Neural Network Architecture">Learning ESP-DL Series 03: Neural Network Architecture</a><time datetime="2025-08-27T07:58:43.000Z" title="Created 2025-08-27 15:58:43">2025-08-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/27/Learning-ESP-DL-Series-02-Walkthrough-on-training-test-deploy/" title="Learning ESP-DL Series 02: Walkthrough on Training, Testing, and Deployment">Learning ESP-DL Series 02: Walkthrough on Training, Testing, and Deployment</a><time datetime="2025-08-27T00:48:57.000Z" title="Created 2025-08-27 08:48:57">2025-08-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/18/Learning-ESP-DL-Series-01-Digi-Recognition/" title="Learning ESP-DL Series 01: Digit Recognition">Learning ESP-DL Series 01: Digit Recognition</a><time datetime="2025-08-18T02:06:03.000Z" title="Created 2025-08-18 10:06:03">2025-08-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/15/Learning-ESP-DL-Series-00-First-Impression/" title="Learning ESP-DL Series 2025 - 00: First Impression">Learning ESP-DL Series 2025 - 00: First Impression</a><time datetime="2025-08-15T05:30:25.000Z" title="Created 2025-08-15 13:30:25">2025-08-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/29/Learning-Pytorch-in-2025/" title="Learning ESP32-DL library &amp; Pytorch in 2025">Learning ESP32-DL library &amp; Pytorch in 2025</a><time datetime="2025-07-29T02:16:32.000Z" title="Created 2025-07-29 10:16:32">2025-07-29</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By tommok</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.3</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>